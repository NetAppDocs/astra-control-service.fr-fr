---
sidebar: sidebar 
permalink: use/enable-acp.html 
keywords: Astra Control Provisioner install, acp, enable, astra trident upgrade, upgrade trident 
summary: Activez le mécanisme de provisionnement Astra Control pour accéder à une fonctionnalité avancée de provisionnement et de gestion du stockage. 
---
= Activez le mécanisme de provisionnement Astra Control
:hardbreaks:
:allow-uri-read: 
:icons: font
:imagesdir: ../media/use/


[role="lead"]
Les versions 23.10 et ultérieures d'Astra Trident incluent la possibilité d'utiliser Astra Control Provisioner qui permet aux utilisateurs d'Astra Control sous licence d'accéder à des fonctionnalités avancées de provisionnement du stockage. ASTRA Control Provisioner offre cette fonctionnalité étendue en plus des fonctionnalités standard d'Astra Trident CSI. Vous pouvez utiliser cette procédure pour activer et installer Astra Control Provisioner.

Votre abonnement à Astra Control Service inclut automatiquement la licence pour l'utilisation d'Astra Control Provisioner.

Dans les prochaines mises à jour d'Astra Control, Astra Control Provisioner remplacera Astra Trident en tant que mécanisme de provisionnement et d'orchestration du stockage, et sera obligatoire pour l'utilisation d'Astra Control. Pour cette raison, il est fortement recommandé aux utilisateurs d'Astra Control d'activer Astra Control Provisioner. ASTRA Trident continuera à rester open source et sera publié, maintenu, pris en charge et mis à jour avec le nouveau CSI et d'autres fonctionnalités de NetApp.

.Comment savoir si j'ai besoin d'activer Astra Control provisionner ?
Si vous ajoutez un cluster à Astra Control Service qui ne possède pas encore Astra Trident, le cluster sera marqué comme `Eligible`. Après vous link:../get-started/add-first-cluster.html["Ajoutez le cluster à Astra Control"], Astra Control Provisioner sera automatiquement activé.

Si votre cluster n'est pas marqué `Eligible`, il sera marqué `Partially eligible` pour l'une des raisons suivantes :

* Il utilise une version plus ancienne d'Astra Trident
* Il utilise une Astra Trident 23.10 qui ne dispose pas encore de l'option de provisionnement activée
* Il s'agit d'un type de cluster qui ne permet pas l'activation automatique


Pour `Partially eligible` Cas d'utilisation, suivez ces instructions pour activer manuellement le mécanisme de provisionnement Astra Control pour votre cluster.

image:ac-acp-eligibility.png["Capture d'écran illustrant l'éligibilité d'un cluster dans le workflow d'ajout de cluster"]

.Avant d'activer Astra Control Provisioner
Si vous disposez d'une Astra Trident sans Astra Control Provisioner et que vous souhaitez activer Astra Control Provisioner, effectuez d'abord les opérations suivantes :

* *Si vous avez installé Astra Trident, vérifiez que sa version se trouve dans une fenêtre à quatre versions*: Vous pouvez effectuer une mise à niveau directe vers Astra Trident 24.02 avec Astra Control Provisioner si votre Astra Trident se trouve dans une fenêtre à quatre versions de la version 24.02. Par exemple, vous pouvez effectuer une mise à niveau directe d'Astra Trident 23.04 vers la version 24.02.
* *Confirmez que votre cluster a une architecture système AMD64* : l'image Astra Control Provisioner est fournie dans les architectures CPU AMD64 et ARM64, mais seul AMD64 est pris en charge par Astra Control.


.Étapes
. Accédez au registre d'images NetApp Astra Control :
+
.. Connectez-vous à l'interface utilisateur d'Astra Control Service et enregistrez votre ID de compte Astra Control.
+
... Sélectionnez l'icône de figure en haut à droite de la page.
... Sélectionnez *accès API*.
... Notez votre ID de compte.


.. A partir de la même page, sélectionnez *générer jeton API* et copiez la chaîne de jeton API dans le presse-papiers et enregistrez-la dans votre éditeur.
.. Connectez-vous au registre Astra Control à l'aide de la méthode de votre choix :
+
[source, docker]
----
docker login cr.astra.netapp.io -u <account-id> -p <api-token>
----
+
[source, crane]
----
crane auth login cr.astra.netapp.io -u <account-id> -p <api-token>
----


. (Registres personnalisés uniquement) Suivez ces étapes pour déplacer l'image vers votre registre personnalisé. Si vous n'utilisez pas de registre, suivez les étapes de l'opérateur Trident dans le <<no-registry,section suivante>>.
+

NOTE: Vous pouvez utiliser Podman à la place de Docker pour les commandes suivantes. Si vous utilisez un environnement Windows, PowerShell est recommandé.

+
[role="tabbed-block"]
====
.Docker
--
.. Extrayez l'image Astra Control Provisioner du Registre :
+

NOTE: L'image extraite ne prend pas en charge plusieurs plates-formes et ne prend en charge que la même plate-forme que l'hôte qui a extrait l'image, comme Linux AMD64.

+
[source, console]
----
docker pull cr.astra.netapp.io/trident-acp:24.02.0 --platform <cluster platform>
----
+
Exemple :

+
[listing]
----
docker pull cr.astra.netapp.io/trident-acp:24.02.0 --platform linux/amd64
----
.. Marquer l'image :
+
[source, console]
----
docker tag cr.astra.netapp.io/trident-acp:24.02.0 <my_custom_registry>/trident-acp:24.02.0
----
.. Envoyez l'image vers votre registre personnalisé :
+
[source, console]
----
docker push <my_custom_registry>/trident-acp:24.02.0
----


--
.Grue
--
.. Copiez le manifeste Astra Control Provisioner dans votre registre personnalisé :
+
[source, crane]
----
crane copy cr.astra.netapp.io/trident-acp:24.02.0 <my_custom_registry>/trident-acp:24.02.0
----


--
====
. Déterminez si la méthode d'installation d'Astra Trident d'origine utilise un.
. Activez Astra Control Provisioner dans Astra Trident en utilisant la méthode d'installation que vous avez utilisée initialement :
+
Directive non résolue dans <stdin> - include::https://raw.githubusercontent.com/NetAppDocs/astra-control-center/main/_include/enable-acp-options-tabbed-block.adoc[]



.Résultat
La fonctionnalité Astra Control Provisioner est activée et vous pouvez utiliser toutes les fonctions disponibles pour la version que vous exécutez.

Après l'installation d'Astra Control Provisioner, le cluster qui héberge le provisionneur dans l'interface utilisateur d'Astra Control affiche un `ACP version` plutôt que `Trident version` et le numéro de version actuellement installé.

image:ac-acp-version.png["Capture d'écran illustrant l'emplacement de la version ACP dans l'interface utilisateur"]

.Pour en savoir plus
* https://docs.netapp.com/us-en/trident/trident-managing-k8s/upgrade-operator-overview.html["Documentation sur les mises à niveau d'Astra Trident"^]

